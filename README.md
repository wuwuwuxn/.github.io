# 行政处罚数据分析程序

## 程序简介

这是一个专门用于分析行政处罚Excel文件的综合数据分析程序。程序能够自动读取Excel文件，按照预设规则进行数据清洗和分析，生成详细的分析报告和可视化图表。

## 功能特性

### 🎯 核心功能
- **自动字段识别**：智能识别Excel中的核心字段（违规类型、违规行为、处分类型、所属行业等）
- **多值字段处理**：支持逗号分隔的多值字段拆分和分别统计
- **数据清洗**：自动过滤空行、重复行和非监管机构处理的案件
- **公开处罚筛选**：自动筛选公开处罚案件进行深度分析

### 📊 分析模块

#### 模块1：处分类型统计
- 提取所有处分类型并统计案例数量
- 生成饼图和表格展示
- 支持占比计算和排序

#### 模块2：违规类型统计  
- 提取所有违规类型并统计案例数量
- 可视化展示各类违规的分布情况
- 支持多维度分析

#### 模块3：违规类型与处分类型关联分析
- 分析违规类型与处分类型的对应关系
- 生成热力图展示关联强度
- 计算各组合的占比和频次

#### 模块4：财务类违规的行业分布分析
- 筛选财务类违规案件
- 按行业统计违规案例数量和占比
- 生成行业排名和分布图表

#### 模块5：财务类公开处罚案件的违规行为深度拆解
- 提取具体的造假手段和操作方式
- 统计各类造假手段的出现频次
- 选取代表性案例进行深度分析

## 使用方法

### 1. 准备Excel文件
确保Excel文件包含以下核心字段（列名可以不同，程序会自动识别）：

- **违规类型**：案件的违规类型分类
- **违规行为**：具体的违规事实描述
- **处分类型**：监管机构的处分措施
- **Wind行业/所属行业**：案件主体的行业分类
- **处理人/处罚机构**：处理案件的监管机构
- **处罚案号**：案件编号（可选）
- **处罚金额(万元)**：罚款金额（可选）
- **处分措施**：具体的处分内容（可选）

### 2. 运行程序

```bash
python administrative_penalty_analyzer.py <Excel文件路径>
```

### 3. 查看结果
程序运行后会生成以下文件：
- `index.html`：完整的分析报告网页
- `analysis_results.json`：详细的分析结果数据

## 数据清洗规则

1. **空行过滤**：删除完全空白的行
2. **重复行过滤**：删除重复的记录
3. **处理人过滤**：只保留处理人包含"证券"、"证监"、"交易"、"中小"、"股转"、"创业板"的案件
4. **公开处罚过滤**：只保留处分类型包含"公开"的案件

## 统计规则

### 多值处理规则
- 当案件涉及多种违规类型或处分类型时，程序会：
  - 按逗号分隔拆分多个类型
  - 分别计入对应类型的统计
  - 案件总数不重复计算
  - 各类型频次分别统计

### 占比计算
- 各处分类型占比 = 该类型案例数 ÷ 总案例数 × 100%
- 各行业财务违规占比 = 该行业案例数 ÷ 财务类违规总案例数 × 100%
- 违规-处分组合占比 = 该组合案例数 ÷ 该违规类型总案例数 × 100%

## 输出内容

### 网页报告包含：
1. **数据概览**：总案件数、处分类型数、违规类型数、财务类违规数
2. **处分类型统计**：饼图 + 表格
3. **违规类型统计**：饼图 + 表格  
4. **关联分析**：违规类型与处分类型关联热力图
5. **行业分布**：财务类违规行业分布柱状图 + 排名表格
6. **深度拆解**：造假手段统计饼图 + 代表性案例详情

### JSON数据包含：
- 所有统计结果的原始数据
- 支持进一步分析和定制化报告

## 技术特性

- **自动字段匹配**：支持多种字段名称变体
- **智能数据清洗**：多层次数据过滤和验证
- **响应式设计**：支持各种屏幕尺寸
- **交互式图表**：ECharts可视化展示
- **模块化设计**：各分析模块独立运行

## 注意事项

1. **Excel格式要求**：
   - 单工作表结构
   - 每行对应一个独立案件
   - 列名清晰明确

2. **数据质量建议**：
   - 确保监管机构名称规范
   - 处分类型和违规类型分类清晰
   - 行业分类使用标准分类体系

3. **性能考虑**：
   - 适用于中等规模数据集（几千到几万行）
   - 大数据集可能需要优化处理时间

## 示例数据

如果没有真实的Excel文件，程序会使用内置的示例数据进行演示，展示完整的分析流程和报告效果。

## 故障排除

### 常见问题：
1. **字段识别失败**：检查Excel列名是否与标准字段匹配
2. **数据为空**：确认Excel文件路径正确且有数据
3. **图表不显示**：检查浏览器是否支持JavaScript

### 解决方案：
- 确保Excel文件格式正确
- 检查文件路径和权限
- 使用现代浏览器查看报告

## 扩展功能

程序设计支持以下扩展：
- 添加新的分析维度
- 自定义数据清洗规则
- 扩展可视化图表类型
- 支持更多数据源格式

---

**版本**: 1.0.0  
**更新时间**: 2024年  
**技术支持**: 基于Python + ECharts + Tailwind CSS